# Universal SQL MCP Server

A powerful **Model Context Protocol (MCP)** server that allows AI agents (like Cursor, Claude Desktop, or custom clients) to interact with your databases directly. It supports **MySQL**, **PostgreSQL**, and **SQLite**.

## üöÄ What is this?

This server acts as a bridge between an AI model and your database. Instead of copying and pasting database schemas, you can simply ask the AI to "list my tables", "describe a table", or "find the last 10 orders". The AI will use the tools provided by this server to fetch the data it needs to help you code better.

## ‚öôÔ∏è How it works

The server implements the **Model Context Protocol (MCP)**. It runs as a background process on your machine. When you ask Cursor a question about your database:
1. **Cursor** identifies the appropriate tool (e.g., `list_tables`).
2. **Cursor** sends a request to this server via Standard Input/Output (stdio).
3. **The Server** executes the corresponding SQL command using **Knex.js**.
4. **The Server** returns the data as JSON to Cursor.
5. **Cursor** interprets the JSON and provides you with a natural language answer.

## ‚ú® Features

- **Multi-Database Support**: Connect to MySQL, Postgres, or SQLite using the same server.
- **Full CRUD Support**:
  - `list_tables`: See all tables in your database.
  - `describe_table`: Get detailed column information (types, keys, etc.).
  - `execute_query`: Run raw `SELECT` queries for data analysis.
  - `insert_data`: Add new records via AI prompts.
  - `update_data`: Modify existing records easily.
  - `delete_data`: Remove records based on specific criteria.
- **Security**: Designed to run locally on your machine, giving you full control over database access.

## üõ†Ô∏è Installation

1. **Clone the repository**:
   ```bash
   git clone <your-repo-url>
   cd db_mcp
   ```

2. **Install dependencies**:
   ```bash
   npm install
   ```

3. **Configure environment variables**:
   Create a `.env` file in the root directory:
   ```env
   DB_TYPE=mysql2  # Options: mysql2, pg, sqlite3
   DB_HOST=localhost
   DB_PORT=3306
   DB_USER=root
   DB_PASSWORD=your_password
   DB_DATABASE=your_db_name
   # SQLITE_PATH=./database.sqlite (Only for sqlite3)
   ```

4. **Build the project**:
   ```bash
   npm run build
   ```

## üîå How to use in Cursor

### Method 1: Global `mcp.json` (Recommended)

Add this configuration to your Cursor's global MCP settings file located at `%USERPROFILE%\.cursor\mcp.json` (Windows) or `~/.cursor/mcp.json` (macOS/Linux):

```json
{
  "mcpServers": {
    "universal-db-mcp": {
      "command": "node",
      "args": ["D:/App/db_mcp/build/index.js"],
      "env": {
        "DB_TYPE": "mysql2",
        "DB_HOST": "localhost",
        "DB_PORT": "3306",
        "DB_USER": "root",
        "DB_PASSWORD": "",
        "DB_DATABASE": "test"
      }
    }
  }
}
```
*Note: Ensure the path in `args` points to your actual project location.*

### Method 2: Cursor UI
1. Open Cursor Settings -> Features -> MCP.
2. Click **+ Add New MCP Server**.
3. Name: `Universal DB`
4. Type: `command`
5. Command: `node D:/App/db_mcp/build/index.js`

## üí¨ Sample Prompts

Once configured, you can talk to your database in Cursor Chat (`Ctrl+L`):

- **Explore**: "What tables are in my database?"
- **Understand**: "Describe the structure of the `users` table."
- **Read**: "Show me the 5 most recent entries from the `blogs` table."
- **Write**: "Add a new user with name 'Alice' and email 'alice@example.com'."
- **Update**: "Change the status of order #5 to 'completed'."
- **Complex**: "Find all products that have never been ordered and list their names."

## üìú Available Commands

- `npm run build`: Compiles TypeScript to JavaScript in the `build/` folder.
- `npm start`: Runs the compiled server (used by MCP clients).
- `npm run dev`: Runs the server directly using `ts-node` for development.

## üõ°Ô∏è Security Note

This server allows the AI to perform write operations (`INSERT`, `UPDATE`, `DELETE`). Always review the SQL queries generated by the AI before confirming if prompted, and use a database user with the minimum required permissions.
